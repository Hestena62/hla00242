<!--
╔══════════════════════════════════════════════════════════════════════════════╗
║                  HESTEN'S ACADEMIC PORTFOLIO - DOCUMENTATION                 ║
╚══════════════════════════════════════════════════════════════════════════════╝

PROJECT OVERVIEW
═══════════════════════════════════════════════════════════════════════════════
A responsive, single-page academic portfolio showcasing Hesten's educational 
journey from Community College of Vermont (CCV) to University of Vermont (UVM).
Built with vanilla JavaScript, Tailwind CSS, and Lucide icons.

FEATURES
═══════════════════════════════════════════════════════════════════════════════
✓ Dark/Light theme toggle with localStorage persistence
✓ Dynamic JSON-driven content rendering
✓ Modal system with deep linking support (History API)
✓ Responsive navigation with mobile menu
✓ Intersection Observer for fade-in animations
✓ Searchable notes/snippets with pagination
✓ Interactive timeline with expandable details
✓ Tabbed course modules with weekly assignments
✓ Keyboard navigation (Escape to close modals)
✓ Accessibility-first design (semantic HTML, ARIA labels)

MAIN SECTIONS
═══════════════════════════════════════════════════════════════════════════════

1. HERO SECTION
    - Animated blob backgrounds using mix-blend-multiply
    - Call-to-action buttons (View Coursework, Contact Me)

2. ABOUT SECTION
    - Bio and academic background
    - Current focus areas (Full Stack Dev, Data Structures, Tech Writing)
    - Modal link to detailed academic philosophy

3. TIMELINE SECTION
    - Responsive vertical timeline (alternating left/right on desktop)
    - 4 major milestones with expandable modals
    - Color-coded by achievement type

4. COURSEWORK SECTION
    - Grid layout of current courses
    - Click to open detailed course modal with week-by-week breakdown
    - Each week includes: notes, assignments, quiz results

5. PORTFOLIO/PROJECTS SECTION
    - 4 featured projects with descriptions and tech stack tags
    - Interactive cards with detailed project modals
    - Links to GitHub profile

6. DIGITAL NOTEBOOK SECTION
    - 8+ searchable study notes/snippets
    - Full-text search by title and keywords
    - Pagination ("Load More" button)
    - Each note has summary and expanded full content

TECHNICAL ARCHITECTURE
═══════════════════════════════════════════════════════════════════════════════

STYLESHEETS & SCRIPTS:
• Tailwind CSS (CDN + custom config)
• Lucide Icons (SVG library)
• Google Fonts (Inter, sans-serif)
• Custom animations (fade-in, blob, modal transitions)

STATE MANAGEMENT:
  Object: state
  - notesVisibleCount: Number of notes to display (default 6)
  - notesIncrement: Pagination step (default 3)
  - isModalOpen: Boolean flag for modal state
  - currentTheme: 'dark' or 'light'

CORE MODULES:

1. themeManager
    init()          - Initialize theme from localStorage/system preference
    toggle()        - Switch between dark/light mode
    updateIcons()   - Refresh Lucide icons after theme change

2. render
    init()          - Render all sections + setup observers
    timeline()      - Generate timeline items from portfolioData
    courses()       - Generate course cards grid
    projects()      - Generate project cards grid
    notes()         - Generate note cards with filtering support
    observeAnimations() - Setup Intersection Observer for fade-in

3. modalManager
    open(key)       - Open modal by key (static modal, timeline, project, note, course)
    close()         - Animate and close modal
    generateTabs()  - Create tabbed interface for course modules
    setupTabs()     - Attach click handlers to tab buttons

DATA STRUCTURE
═══════════════════════════════════════════════════════════════════════════════

portfolioData = {
  modals: {
     'contact-info': { title, content (HTML) },
     'studies-overview': { title, content (HTML) }
  },
  timeline: [
     { id, date, title, description, icon, color, align, details, active }
  ],
  courses: [
     { 
        id, semester, title, description, icon, color,
        weeks: [{ week, title, content: { notes, assignment, quiz } }]
     }
  ],
  projects: [
     { id, title, description, icon, tags, color, details }
  ],
  notes: [
     { id, title, summary, keywords, fullContent }
  ]
}

MODAL ROUTING PATTERNS
═══════════════════════════════════════════════════════════════════════════════
data-modal-key="contact-info"      → Static modal from portfolioData.modals
data-modal-key="studies-overview"  → Static modal from portfolioData.modals
data-modal-key="timeline-1"        → Timeline item #1
data-modal-key="course-cis-2230"   → Course with tabbed weeks
data-modal-key="project-p1"        → Project details
data-modal-key="note-3"            → Note/snippet full content

ACCESSIBILITY FEATURES
═══════════════════════════════════════════════════════════════════════════════
✓ Semantic HTML5 (nav, main, section, footer, article)
✓ aria-label on icon-only buttons
✓ aria-hidden on modal backdrop
✓ aria-modal on modal dialog
✓ role="dialog" on modal container
✓ WCAG color contrast ratios maintained
✓ Keyboard navigation (Tab, Escape)
✓ Lucide icons with accessible SVG structure

BROWSER COMPATIBILITY
═══════════════════════════════════════════════════════════════════════════════
✓ Modern browsers (Chrome, Firefox, Safari, Edge)
✓ CSS Grid, Flexbox, CSS Variables
✓ ES6+ JavaScript (arrow functions, template literals, spread operator)
✓ LocalStorage API
✓ History API (for deep linking)
✓ Intersection Observer API

RESPONSIVE BREAKPOINTS
═══════════════════════════════════════════════════════════════════════════════
• Mobile (default)
• md: 768px
• lg: 1024px
• Tailwind's responsive prefixes (md:, lg:) used throughout

KEY EVENT LISTENERS
═══════════════════════════════════════════════════════════════════════════════
• DOMContentLoaded → Initialize app
• click #theme-toggle → Toggle dark mode
• click #mobile-menu-btn → Toggle mobile menu
• input #notes-search → Filter notes in real-time
• click [data-modal-key] → Trigger modal (delegated)
• click #modal-close → Close modal
• click #modal-backdrop → Close modal (backdrop click)
• keydown (Escape) → Close modal
• popstate → Handle browser back/forward with History API

CUSTOMIZATION NOTES
═══════════════════════════════════════════════════════════════════════════════
To add/modify content:
1. Edit portfolioData object in <script id="portfolio-data">
2. Update timeline, courses, projects, notes arrays
3. Modal content is HTML-rendered (innerHTML safe for trusted content)
4. Tailwind config colors available: primary-* (sky blue), dark.* (slate)

To add new modal types:
1. Add entry to portfolioData.modals OR
2. Add conditional branch in modalManager.open() with new key pattern
3. Trigger with: <div data-modal-key="my-key">

DEPLOYMENT CONSIDERATIONS
═══════════════════════════════════════════════════════════════════════════════
✓ Single HTML file - no build step required
✓ CDN dependencies: Tailwind, Lucide, Google Fonts (requires internet)
✓ All data embedded in <script id="portfolio-data">
✓ No backend required
✓ Works with static hosting (GitHub Pages, Vercel, Netlify, etc.)

VERSION: 1.0
CREATED: 2024
AUTHOR: Hesten's Portfolio
-->

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hesten's Academic Portfolio & Journey</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Tailwind Config & Custom Styles -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7', // Sky Blue
                            700: '#0369a1',
                            900: '#0c4a6e',
                        },
                        dark: {
                            bg: '#0f172a',
                            card: '#1e293b',
                            text: '#f1f5f9'
                        }
                    },
                    boxShadow: {
                        'lg-2': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                        'xl-2': '0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)',
                        'dark-xl': '0 20px 25px -5px rgba(0, 0, 0, 0.5), 0 10px 10px -5px rgba(0, 0, 0, 0.3)',
                    }
                }
            }
        }
    </script>

    <style>
        /* Custom Utilities */
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        
        /* Hide scrollbar for clean modal content */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* Animation Classes */
        .fade-in-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
            will-change: opacity, visibility;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: none;
        }

        /* Modal Transitions */
        .modal-backdrop {
            transition: opacity 0.3s ease;
        }
        .modal-content {
            transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1), opacity 0.3s ease;
        }
        
        /* Clickable Cards */
        .interactive-card {
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .interactive-card:active {
            transform: scale(0.98);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 dark:bg-dark-bg dark:text-slate-100 transition-colors duration-300">

    <!-- Navigation -->
    <nav class="fixed w-full z-40 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-slate-200 dark:border-slate-700 transition-colors duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex-shrink-0 cursor-pointer" onclick="window.scrollTo(0,0)">
                    <span class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary-600 to-indigo-600 dark:from-primary-500 dark:to-indigo-400">
                        Hesten.
                    </span>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-8">
                        <a href="#about" class="hover:text-primary-600 dark:hover:text-primary-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">About</a>
                        <a href="#timeline" class="hover:text-primary-600 dark:hover:text-primary-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">Timeline</a>
                        <a href="#courses" class="hover:text-primary-600 dark:hover:text-primary-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">Coursework</a>
                        <a href="#projects" class="hover:text-primary-600 dark:hover:text-primary-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">Portfolio</a>
                        <a href="#notes" class="hover:text-primary-600 dark:hover:text-primary-400 px-3 py-2 rounded-md text-sm font-medium transition-colors">Notebook</a>
                    </div>
                </div>

                <!-- Right Side Actions -->
                <div class="flex items-center gap-4">
                    <!-- Theme Toggle -->
                    <button id="theme-toggle" class="p-2 rounded-full hover:bg-slate-200 dark:hover:bg-slate-800 transition-colors" aria-label="Toggle Dark Mode">
                        <i data-lucide="moon" class="w-5 h-5 hidden dark:block"></i>
                        <i data-lucide="sun" class="w-5 h-5 block dark:hidden"></i>
                    </button>

                    <!-- Mobile Menu Button -->
                    <div class="-mr-2 flex md:hidden">
                        <button id="mobile-menu-btn" class="p-2 rounded-md text-slate-600 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-800">
                            <i data-lucide="menu" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#about" class="block hover:bg-slate-100 dark:hover:bg-slate-800 px-3 py-2 rounded-md text-base font-medium">About</a>
                <a href="#timeline" class="block hover:bg-slate-100 dark:hover:bg-slate-800 px-3 py-2 rounded-md text-base font-medium">Timeline</a>
                <a href="#courses" class="block hover:bg-slate-100 dark:hover:bg-slate-800 px-3 py-2 rounded-md text-base font-medium">Coursework</a>
                <a href="#projects" class="block hover:bg-slate-100 dark:hover:bg-slate-800 px-3 py-2 rounded-md text-base font-medium">Portfolio</a>
                <a href="#notes" class="block hover:bg-slate-100 dark:hover:bg-slate-800 px-3 py-2 rounded-md text-base font-medium">Notebook</a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="pt-16">
        
        <!-- Hero Section -->
        <section id="hero" class="relative min-h-[80vh] flex items-center justify-center overflow-hidden">
            <div class="absolute inset-0 z-0">
                <div class="absolute inset-0 bg-gradient-to-br from-primary-50 to-indigo-100 dark:from-slate-900 dark:to-slate-800 opacity-90"></div>
                <!-- Animated blob background simulation -->
                <div class="absolute top-20 left-20 w-72 h-72 bg-purple-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob"></div>
                <div class="absolute top-20 right-20 w-72 h-72 bg-yellow-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-2000"></div>
                <div class="absolute -bottom-8 left-1/2 w-72 h-72 bg-pink-300 rounded-full mix-blend-multiply filter blur-xl opacity-30 animate-blob animation-delay-4000"></div>
            </div>

            <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center fade-in-section">
                <div class="inline-block p-2 px-4 rounded-full bg-white/50 dark:bg-slate-800/50 backdrop-blur-sm border border-slate-200 dark:border-slate-700 mb-6 shadow-sm">
                    <span class="text-primary-600 dark:text-primary-400 font-medium text-sm">Welcome to my Academic Journey</span>
                </div>
                <h1 class="text-5xl md:text-7xl font-extrabold tracking-tight mb-6 text-slate-900 dark:text-white">
                    Hi, I'm <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary-600 to-indigo-600 dark:from-primary-400 dark:to-indigo-400">Hesten</span>.
                </h1>
                <p class="mt-4 max-w-2xl mx-auto text-xl text-slate-600 dark:text-slate-300">
                    A dedicated student transitioning from <strong>Community College of Vermont</strong> to the <strong>University of Vermont</strong>. 
                    Explore my coursework, research projects, and digital notebook.
                </p>
                <div class="mt-10 flex justify-center gap-4">
                    <button onclick="document.getElementById('courses').scrollIntoView()" class="px-8 py-3 rounded-lg bg-primary-600 hover:bg-primary-700 text-white font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300">
                        View Coursework
                    </button>
                    <button data-modal-key="contact-info" class="px-8 py-3 rounded-lg bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-900 dark:text-white font-medium shadow-sm transition-all duration-300">
                        Contact Me
                    </button>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-24 bg-white dark:bg-slate-900">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center fade-in-section">
                    <div>
                        <h2 class="text-3xl font-bold mb-6 text-slate-900 dark:text-white">From CCV to UVM</h2>
                        <div class="space-y-4 text-lg text-slate-600 dark:text-slate-300">
                            <p>
                                My academic path has been defined by curiosity and resilience. Starting at High School, I quickly realized my passion for technology and systematic problem solving.
                            </p>
                            <p>
                                At the Community College of Vermont (CCV), I built a strong foundation in Computer Science, maintaining a 3.9 GPA while working part-time. Now, as I transition to the University of Vermont (UVM), I am focused on advanced software engineering and data science.
                            </p>
                        </div>
                        <div class="mt-8 flex flex-wrap gap-4">
                            <div class="flex items-center gap-2 text-slate-700 dark:text-slate-300">
                                <i data-lucide="map-pin" class="w-5 h-5 text-primary-600"></i>
                                <span>Burlington, VT</span>
                            </div>
                            <div class="flex items-center gap-2 text-slate-700 dark:text-slate-300">
                                <i data-lucide="graduation-cap" class="w-5 h-5 text-primary-600"></i>
                                <span>Junior Standing</span>
                            </div>
                        </div>
                        <button data-modal-key="studies-overview" class="mt-8 text-primary-600 dark:text-primary-400 font-medium hover:underline inline-flex items-center">
                            Read detailed academic philosophy <i data-lucide="arrow-right" class="w-4 h-4 ml-1"></i>
                        </button>
                    </div>
                    <div class="relative">
                        <div class="absolute inset-0 bg-primary-600 rounded-2xl transform rotate-3 opacity-10"></div>
                        <div class="relative bg-slate-50 dark:bg-slate-800 p-8 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-xl-2">
                            <h3 class="text-xl font-bold mb-4 dark:text-white">Current Focus</h3>
                            <ul class="space-y-3">
                                <li class="flex items-start">
                                    <i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 mr-3 mt-1"></i>
                                    <span class="text-slate-600 dark:text-slate-300">Full Stack Web Development</span>
                                </li>
                                <li class="flex items-start">
                                    <i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 mr-3 mt-1"></i>
                                    <span class="text-slate-600 dark:text-slate-300">Data Structures & Algorithms</span>
                                </li>
                                <li class="flex items-start">
                                    <i data-lucide="check-circle-2" class="w-5 h-5 text-green-500 mr-3 mt-1"></i>
                                    <span class="text-slate-600 dark:text-slate-300">Technical Writing</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Timeline Section -->
        <section id="timeline" class="py-24 bg-slate-50 dark:bg-slate-800/50">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16 fade-in-section">
                    <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Academic Milestones</h2>
                    <p class="mt-2 text-slate-600 dark:text-slate-400">The path I've traveled so far (Click for details)</p>
                </div>
                
                <div class="relative" id="timeline-container">
                    <!-- Vertical Line -->
                    <div class="absolute left-4 md:left-1/2 top-0 bottom-0 w-0.5 bg-slate-200 dark:bg-slate-700 transform md:-translate-x-1/2"></div>
                    <!-- JS will inject timeline items here -->
                </div>
            </div>
        </section>

        <!-- Coursework Section -->
        <section id="courses" class="py-24 bg-white dark:bg-slate-900">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center mb-16 fade-in-section">
                    <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Current Coursework</h2>
                    <p class="mt-2 text-slate-600 dark:text-slate-400">Click on any course to view weekly assignments and notes</p>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="courses-grid">
                    <!-- JS will inject courses here -->
                </div>
            </div>
        </section>

        <!-- Projects Section -->
        <section id="projects" class="py-24 bg-slate-50 dark:bg-slate-800/50">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-col md:flex-row justify-between items-end mb-12 fade-in-section">
                    <div>
                        <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Featured Projects</h2>
                        <p class="mt-2 text-slate-600 dark:text-slate-400">Practical application of theory</p>
                    </div>
                    <a href="https://github.com" target="_blank" class="mt-4 md:mt-0 inline-flex items-center text-primary-600 dark:text-primary-400 hover:underline">
                        View GitHub Profile <i data-lucide="external-link" class="w-4 h-4 ml-1"></i>
                    </a>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-8" id="projects-grid">
                    <!-- JS will inject projects here -->
                </div>
            </div>
        </section>

        <!-- Digital Notebook Section -->
        <section id="notes" class="py-24 bg-white dark:bg-slate-900">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="mb-12 fade-in-section">
                    <h2 class="text-3xl font-bold text-slate-900 dark:text-white">Digital Notebook</h2>
                    <p class="mt-2 text-slate-600 dark:text-slate-400 mb-8">Searchable notes, snippets, and study guides. Click to read.</p>
                    
                    <!-- Search Bar -->
                    <div class="relative max-w-xl">
                        <i data-lucide="search" class="absolute left-4 top-3.5 w-5 h-5 text-slate-400"></i>
                        <input type="text" id="notes-search" placeholder="Search notes (e.g., 'react', 'algorithms', 'css')..." 
                            class="w-full pl-12 pr-4 py-3 rounded-xl border border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-primary-500 focus:border-transparent outline-none transition-shadow">
                        <button id="clear-search" class="hidden absolute right-4 top-3.5 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200">
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="notes-grid">
                    <!-- JS will inject notes here -->
                </div>
                
                <div class="mt-12 text-center hidden" id="load-more-container">
                    <button id="load-more-btn" class="px-6 py-2 border border-slate-300 dark:border-slate-600 rounded-full text-sm font-medium hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors dark:text-slate-300">
                        Load More Notes
                    </button>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="bg-slate-900 text-slate-300 py-12 border-t border-slate-800">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <div class="mb-4 md:mb-0">
                        <span class="text-2xl font-bold text-white">Hesten.</span>
                        <p class="text-sm text-slate-500 mt-1">© 2024 Hesten Academic Portfolio.</p>
                    </div>
                    <div class="flex space-x-6">
                        <a href="#" class="hover:text-white transition-colors" aria-label="Github"><i data-lucide="github" class="w-6 h-6"></i></a>
                        <a href="#" class="hover:text-white transition-colors" aria-label="LinkedIn"><i data-lucide="linkedin" class="w-6 h-6"></i></a>
                        <a href="#" class="hover:text-white transition-colors" aria-label="Email"><i data-lucide="mail" class="w-6 h-6"></i></a>
                    </div>
                </div>
            </div>
        </footer>

    </main>

    <!-- Global Modal Container -->
    <div id="modal-backdrop" class="fixed inset-0 z-50 bg-slate-900/70 backdrop-blur-sm hidden flex items-center justify-center p-4 opacity-0 pointer-events-none" aria-hidden="true">
        <div id="modal-container" role="dialog" aria-modal="true" class="bg-white dark:bg-slate-900 w-full max-w-4xl max-h-[90vh] rounded-2xl shadow-2xl flex flex-col transform scale-95 opacity-0 transition-all duration-300 relative overflow-hidden border border-slate-200 dark:border-slate-700">
            
            <!-- Header -->
            <div class="px-6 py-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center bg-white dark:bg-slate-900 z-10">
                <h3 id="modal-title" class="text-xl font-bold text-slate-900 dark:text-white truncate pr-4">Title</h3>
                <button id="modal-close" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-slate-500">
                    <i data-lucide="x" class="w-6 h-6"></i>
                </button>
            </div>

            <!-- Body (Scrollable) -->
            <div id="modal-body" class="flex-1 overflow-y-auto p-6 text-slate-600 dark:text-slate-300">
                <!-- Dynamic Content Injected Here -->
            </div>
        </div>
    </div>

    <!-- DATA SCRIPT -->
    <script id="portfolio-data">
        const portfolioData = {
            // Static content modals
            modals: {
                'contact-info': {
                    title: 'Get in Touch',
                    content: `
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <h4 class="font-bold text-lg mb-4 text-slate-900 dark:text-white">Contact Details</h4>
                                <ul class="space-y-4">
                                    <li class="flex items-center gap-3"><i data-lucide="mail" class="text-primary-600"></i> <a href="mailto:hesten@uvm.edu" class="hover:underline">hesten@uvm.edu</a></li>
                                    <li class="flex items-center gap-3"><i data-lucide="phone" class="text-primary-600"></i> <span>(802) 555-0123</span></li>
                                    <li class="flex items-center gap-3"><i data-lucide="linkedin" class="text-primary-600"></i> <a href="#" class="hover:underline">linkedin.com/in/hesten</a></li>
                                </ul>
                                <div class="mt-6 p-4 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700">
                                    <p class="text-sm">Currently open to summer internships in Software Engineering or Data Analysis.</p>
                                </div>
                            </div>
                            <form class="space-y-4" onsubmit="event.preventDefault(); alert('Message simulation: Sent!');">
                                <input type="text" placeholder="Your Name" class="w-full p-3 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-800" required>
                                <input type="email" placeholder="Your Email" class="w-full p-3 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-800" required>
                                <textarea placeholder="Message" rows="4" class="w-full p-3 rounded-lg border border-slate-200 dark:border-slate-700 dark:bg-slate-800" required></textarea>
                                <button type="submit" class="w-full py-3 bg-primary-600 text-white rounded-lg font-medium hover:bg-primary-700 transition">Send Message</button>
                            </form>
                        </div>
                    `
                },
                'studies-overview': {
                    title: 'Academic Philosophy',
                    content: `
                        <div class="prose dark:prose-invert max-w-none">
                            <p class="text-lg">My educational philosophy centers on the bridge between theoretical computer science and practical application.</p>
                            <h4 class="text-lg font-bold mt-4 mb-2">The Transition: CCV to UVM</h4>
                            <p>At CCV, I focused on the fundamentals. I learned that coding is not just about syntax, but about logic and structure. I took courses in introductory Python, Web Design, and Database Management.</p>
                            <p>Transferring to UVM has allowed me to scale these skills. I am now tackling complex algorithms, operating systems, and team-based software engineering projects.</p>
                            <h4 class="text-lg font-bold mt-4 mb-2">Core Competencies</h4>
                            <div class="grid grid-cols-2 gap-4 mt-4">
                                <div class="p-4 border border-slate-200 dark:border-slate-700 rounded-lg">
                                    <strong>Languages</strong><br>JavaScript, Python, C++, Java
                                </div>
                                <div class="p-4 border border-slate-200 dark:border-slate-700 rounded-lg">
                                    <strong>Tools</strong><br>Git, Docker, VS Code, React
                                </div>
                            </div>
                        </div>
                    `
                }
            },
            
            timeline: [
                { 
                    id: 1, 
                    date: 'May 2020', 
                    title: 'High School Diploma', 
                    description: 'Graduated with Honors. Focus on Mathematics and Physics.', 
                    icon: 'award', 
                    color: 'bg-indigo-500', 
                    align: 'left',
                    details: `<p>During my high school years, I developed a strong interest in STEM fields. I was president of the Robotics club and took AP Calculus and AP Physics. This period cemented my desire to pursue engineering and computer science.</p><p class="mt-2"><strong>Key Achievements:</strong></p><ul class="list-disc pl-5"><li>National Honor Society Member</li><li>Robotics Team Captain</li><li>GPA: 3.8</li></ul>`
                },
                { 
                    id: 2, 
                    date: 'Sept 2021', 
                    title: 'Started at CCV', 
                    description: 'Enrolled in Computer Systems Associate degree program.', 
                    icon: 'book-open', 
                    color: 'bg-primary-500', 
                    align: 'right',
                    details: `<p>At the Community College of Vermont, I specialized in Computer Systems. I balanced a full course load with part-time work, developing time management skills essential for my future career.</p><p class="mt-2"><strong>Course Highlights:</strong></p><ul class="list-disc pl-5"><li>Intro to Programming (Python)</li><li>Database Management Systems</li><li>Networking Fundamentals</li></ul>`
                },
                { 
                    id: 3, 
                    date: 'May 2023', 
                    title: 'Graduated CCV', 
                    description: 'Associates Degree in STEM Studies. GPA: 3.9.', 
                    icon: 'graduation-cap', 
                    color: 'bg-green-500', 
                    align: 'left',
                    details: `<p>I graduated Summa Cum Laude with an Associate of Science in STEM Studies. My capstone project involved creating a database system for a local non-profit library.</p><p class="mt-2"><strong>Awards:</strong></p><ul class="list-disc pl-5"><li>Dean's List (All Semesters)</li><li>STEM Excellence Award</li></ul>`
                },
                { 
                    id: 4, 
                    date: 'Sept 2024', 
                    title: 'Transferred to UVM', 
                    description: 'Matriculated into BS Computer Science program.', 
                    icon: 'school', 
                    color: 'bg-purple-500', 
                    align: 'right', 
                    active: true,
                    details: `<p>I am currently a junior at the University of Vermont. The transition has been seamless thanks to the strong foundation built at CCV. I am now focusing on advanced data structures, algorithms, and software engineering principles.</p><p class="mt-2"><strong>Current Goals:</strong></p><ul class="list-disc pl-5"><li>Secure a Summer Internship</li><li>Contribute to Open Source Projects</li><li>Maintain 3.8+ GPA</li></ul>`
                }
            ],

            courses: [
                {
                    id: 'cis-2230',
                    semester: 'Fall 2024',
                    title: 'Web Development I',
                    description: 'Modern frontend development using HTML5, CSS3, and JavaScript ES6+.',
                    icon: 'layout',
                    color: 'text-blue-500',
                    weeks: [
                        {
                            week: 1,
                            title: 'HTML Semantics & Structure',
                            content: {
                                notes: '<p>Focus on accessibility and the document object model (DOM). Key tags discussed: &lt;nav&gt;, &lt;main&gt;, &lt;article&gt;.</p><ul class="list-disc pl-5 mt-2"><li>Semantic HTML importance</li><li>ARIA roles intro</li></ul>',
                                quiz: '<p class="font-bold">Score: 10/10</p><p>Topics: Block vs Inline elements, Attributes.</p>',
                                assignment: '<p>Built a resume page using only semantic HTML tags. Validated using W3C validator.</p>'
                            }
                        },
                        {
                            week: 2,
                            title: 'CSS Box Model & Flexbox',
                            content: {
                                notes: '<p>Understanding margin, border, padding, and content. The <code>box-sizing: border-box</code> reset.</p>',
                                assignment: '<p>Recreated a classic magazine layout using Flexbox.</p>',
                                quiz: '<p class="font-bold">Score: 9/10</p><p>Missed one question on flex-basis vs width.</p>'
                            }
                        }
                    ]
                },
                {
                    id: 'cs-1210',
                    semester: 'Fall 2024',
                    title: 'Computer Organization',
                    description: 'Introduction to computer hardware, assembly language, and memory management.',
                    icon: 'cpu',
                    color: 'text-red-500',
                    weeks: [
                        {
                            week: 1,
                            title: 'Binary & Hexadecimal',
                            content: {
                                notes: '<p>Conversion algorithms between Base-2, Base-10, and Base-16. Two\'s complement for negative numbers.</p>',
                                quiz: '<p class="font-bold">Score: 100%</p>'
                            }
                        },
                        {
                            week: 3,
                            title: 'MIPS Assembly Intro',
                            content: {
                                notes: '<p>Load and Store architecture. Registers $t0-$t9 usage conventions.</p>',
                                assignment: '<p>Write a MIPS program to calculate the Fibonacci sequence.</p>'
                            }
                        }
                    ]
                },
                {
                    id: 'math-2050',
                    semester: 'Fall 2024',
                    title: 'Discrete Mathematics',
                    description: 'Logic, set theory, combinatorics, and graph theory fundamentals.',
                    icon: 'sigma',
                    color: 'text-green-500',
                    weeks: [
                        {
                            week: 1,
                            title: 'Propositional Logic',
                            content: {
                                notes: '<p>Truth tables, implication, and logical equivalence.</p>'
                            }
                        }
                    ]
                }
            ],

            projects: [
                { 
                    id: 'p1', 
                    title: 'Portfolio Site', 
                    description: 'This website! Built with vanilla JS and Tailwind to demonstrate DOM manipulation.', 
                    icon: 'monitor', 
                    tags: ['HTML', 'Tailwind', 'JS'], 
                    color: 'text-indigo-500',
                    details: `<p>This portfolio is a single-page application built without any heavy frameworks like React or Vue, to demonstrate mastery of the DOM APIs and JavaScript fundamentals.</p><h4 class="font-bold mt-4">Key Features</h4><ul class="list-disc pl-5 mt-2"><li>Dynamic JSON-driven content</li><li>Custom Modal System</li><li>History API integration for deep linking</li><li>Dark Mode persistence</li></ul><p class="mt-4"><a href="#" class="text-primary-600 hover:underline">View Source Code</a></p>`
                },
                { 
                    id: 'p2', 
                    title: 'Weather Dashboard', 
                    description: 'Fetches real-time weather data from OpenWeatherMap API with city search history.', 
                    icon: 'cloud-rain', 
                    tags: ['API', 'Async/Await'], 
                    color: 'text-sky-500',
                    details: `<p>A responsive weather dashboard that allows users to search for any city and see current conditions along with a 5-day forecast.</p><h4 class="font-bold mt-4">Technical Challenges</h4><p>Handling asynchronous fetch requests and managing API keys securely. Implemented local storage to save user's search history.</p>`
                },
                { 
                    id: 'p3', 
                    title: 'Task Manager CLI', 
                    description: 'Python-based command line tool for managing todos with file persistence.', 
                    icon: 'terminal', 
                    tags: ['Python', 'File I/O'], 
                    color: 'text-yellow-500',
                    details: `<p>A productivity tool for the terminal. Supports adding, completing, and deleting tasks. Stores data in a JSON file for persistence.</p><h4 class="font-bold mt-4">Learnings</h4><p>Improved understanding of Python's <code>argparse</code> library and file handling/exception safety.</p>`
                },
                { 
                    id: 'p4', 
                    title: 'CCV Library System', 
                    description: 'Database design project modeling a library lending system using SQL.', 
                    icon: 'database', 
                    tags: ['SQL', 'Database'], 
                    color: 'text-green-500',
                    details: `<p>A complete schema design for a library, including tables for Books, Members, Loans, and Fines. Included normalization up to 3NF.</p><h4 class="font-bold mt-4">Scope</h4><p>Wrote complex SQL queries to generate reports on overdue books and popular genres.</p>`
                }
            ],

            notes: [
                { 
                    id: 1, 
                    title: 'CSS Grid vs Flexbox', 
                    summary: 'Grid is 2D, Flex is 1D. Use Grid for layout, Flex for alignment.', 
                    keywords: 'css layout frontend',
                    fullContent: `<p><strong>Flexbox</strong> is designed for one-dimensional layouts (row or column). It excels at distributing space between items and aligning them.</p><p><strong>CSS Grid</strong> is designed for two-dimensional layouts (rows AND columns). It is better for defining the overall layout structure of a page.</p><h3>When to use which?</h3><ul><li>Use Flexbox for navigation bars, aligning buttons, or centering elements.</li><li>Use Grid for the main page layout, photo galleries, or complex card grids.</li></ul>`
                },
                { 
                    id: 2, 
                    title: 'JavaScript Array Methods', 
                    summary: 'Map, Filter, Reduce cheat sheet with examples.', 
                    keywords: 'javascript js coding',
                    fullContent: `<p>A quick reference for modern JS array methods:</p><pre class="bg-slate-100 p-2 rounded mt-2"><code>// Map: Transform elements
const doubled = arr.map(x => x * 2);

// Filter: Select elements
const evens = arr.filter(x => x % 2 === 0);

// Reduce: Aggregate elements
const sum = arr.reduce((acc, curr) => acc + curr, 0);</code></pre>`
                },
                { 
                    id: 3, 
                    title: 'Git Workflow', 
                    summary: 'Standard commands: clone, branch, commit, push, merge.', 
                    keywords: 'git version control',
                    fullContent: `<p><strong>1. Start</strong>: <code>git checkout -b feature-name</code></p><p><strong>2. Work</strong>: Edit files...</p><p><strong>3. Save</strong>: <code>git add .</code> then <code>git commit -m "Message"</code></p><p><strong>4. Share</strong>: <code>git push origin feature-name</code></p><p><strong>5. Merge</strong>: Create a Pull Request.</p>`
                },
                { 
                    id: 4, 
                    title: 'Big O Notation', 
                    summary: 'Time complexity basics. O(1) vs O(n) vs O(log n).', 
                    keywords: 'algorithms cs theory',
                    fullContent: `<p>Big O describes the performance of an algorithm as input size grows.</p><ul><li><strong>O(1)</strong>: Constant time (Array access)</li><li><strong>O(log n)</strong>: Logarithmic (Binary Search)</li><li><strong>O(n)</strong>: Linear (Simple loop)</li><li><strong>O(n^2)</strong>: Quadratic (Nested loops)</li></ul>`
                },
                { 
                    id: 5, 
                    title: 'Accessibility (a11y)', 
                    summary: 'Semantic HTML, ARIA labels, and color contrast ratios.', 
                    keywords: 'accessibility html design',
                    fullContent: `<p>Web accessibility ensures people with disabilities can use your site.</p><h4>Checklist:</h4><ul><li>Use semantic tags (nav, main, footer)</li><li>Alt text for images</li><li>Sufficient color contrast</li><li>Keyboard navigability</li></ul>`
                },
                { 
                    id: 6, 
                    title: 'Python List Comprehension', 
                    summary: 'Writing cleaner loops in a single line of code.', 
                    keywords: 'python coding syntax',
                    fullContent: `<p>Pythonic way to create lists.</p><p>Instead of:</p><pre class="bg-slate-100 p-2 rounded"><code>squares = []
for x in range(10):
    squares.append(x**2)</code></pre><p>Use:</p><pre class="bg-slate-100 p-2 rounded"><code>squares = [x**2 for x in range(10)]</code></pre>`
                },
                { 
                    id: 7, 
                    title: 'REST API Principles', 
                    summary: 'Statelessness, Client-Server, Cacheability.', 
                    keywords: 'web api backend',
                    fullContent: `<p><strong>Stateless:</strong> Server doesn't store client context between requests.</p><p><strong>Resource-Based:</strong> URLs represent resources (nouns), HTTP methods represent actions (verbs).</p><p><strong>Standard Methods:</strong> GET (Read), POST (Create), PUT (Update), DELETE (Remove).</p>`
                },
                { 
                    id: 8, 
                    title: 'React Hooks Intro', 
                    summary: 'useState and useEffect basics.', 
                    keywords: 'react javascript frontend',
                    fullContent: `<p>Hooks allow functional components to have state.</p><p><code>useState</code>: Returns a stateful value and a function to update it.</p><p><code>useEffect</code>: Performs side effects (data fetching, subscriptions) in functional components.</p>`
                },
            ]
        };
    </script>

    <!-- CORE LOGIC -->
    <script>
        // --- State Management ---
        const state = {
            notesVisibleCount: 6,
            notesIncrement: 3,
            isModalOpen: false,
            currentTheme: localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
        };

        // --- Theme Manager ---
        const themeManager = {
            init() {
                if (state.currentTheme === 'dark') {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
                this.updateIcons();
            },
            toggle() {
                state.currentTheme = state.currentTheme === 'dark' ? 'light' : 'dark';
                localStorage.setItem('theme', state.currentTheme);
                document.documentElement.classList.toggle('dark');
                this.updateIcons();
            },
            updateIcons() {
                // Lucide icons handled automatically on re-render
            }
        };

        // --- Render Functions ---
        const render = {
            init() {
                this.timeline();
                this.courses();
                this.projects();
                this.notes();
                lucide.createIcons();
                this.observeAnimations();
            },

            timeline() {
                const container = document.getElementById('timeline-container');
                portfolioData.timeline.forEach((item, index) => {
                    const isLeft = index % 2 === 0;
                    const alignClass = isLeft ? 'md:flex-row-reverse' : '';
                    const textClass = isLeft ? 'md:text-right' : 'md:text-left';
                    const offsetClass = isLeft ? 'md:pr-12' : 'md:pl-12';
                    
                    const html = `
                        <div class="flex items-center justify-between md:justify-center w-full mb-8 ${alignClass} fade-in-section">
                            <div class="hidden md:block w-5/12"></div>
                            
                            <div class="z-10 flex items-center justify-center w-8 h-8 rounded-full ${item.color} shadow-lg shrink-0 border-2 border-white dark:border-slate-800">
                                <i data-lucide="${item.icon}" class="w-4 h-4 text-white"></i>
                            </div>
                            
                            <div class="w-[calc(100%-4rem)] md:w-5/12 pl-4 md:pl-0 ${offsetClass} ${textClass}">
                                <div data-modal-key="timeline-${item.id}" class="interactive-card bg-white dark:bg-slate-800 p-6 rounded-xl shadow-lg-2 border border-slate-100 dark:border-slate-700 hover:shadow-xl-2 hover:border-primary-300 dark:hover:border-primary-700 group">
                                    <span class="text-xs font-bold uppercase tracking-wider text-primary-600 dark:text-primary-400 mb-1 block">${item.date}</span>
                                    <h3 class="text-lg font-bold text-slate-900 dark:text-white group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">${item.title}</h3>
                                    <p class="text-slate-600 dark:text-slate-400 mt-2 text-sm">${item.description}</p>
                                    <div class="mt-3 flex items-center ${isLeft ? 'md:justify-end' : ''} text-xs text-primary-500 font-medium opacity-0 group-hover:opacity-100 transition-opacity">
                                        View Details <i data-lucide="arrow-right" class="w-3 h-3 ml-1"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);
                });
            },

            courses() {
                const container = document.getElementById('courses-grid');
                portfolioData.courses.forEach(course => {
                    // Note: Changed to have the whole card clickable, removing individual week buttons from the main view
                    const html = `
                        <div data-modal-key="course-${course.id}" class="interactive-card bg-white dark:bg-slate-800 rounded-2xl p-6 shadow-lg-2 border border-slate-100 dark:border-slate-700 hover:-translate-y-1 hover:border-primary-300 dark:hover:border-primary-700 transition-all duration-300 fade-in-section group">
                            <div class="flex items-center justify-between mb-4">
                                <div class="p-3 bg-slate-50 dark:bg-slate-700 rounded-xl">
                                    <i data-lucide="${course.icon}" class="w-6 h-6 ${course.color}"></i>
                                </div>
                                <span class="text-xs font-medium px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded text-slate-600 dark:text-slate-300">${course.semester}</span>
                            </div>
                            <h3 class="text-xl font-bold text-slate-900 dark:text-white mb-2 group-hover:text-primary-600 dark:group-hover:text-primary-400 transition-colors">${course.title}</h3>
                            <p class="text-slate-600 dark:text-slate-400 text-sm mb-6 h-10 line-clamp-2">${course.description}</p>
                            
                            <div class="pt-4 border-t border-slate-100 dark:border-slate-700 flex justify-between items-center">
                                <span class="text-xs font-semibold text-slate-400 uppercase tracking-wider">${course.weeks.length} Active Modules</span>
                                <i data-lucide="arrow-right" class="w-4 h-4 text-primary-500 transform group-hover:translate-x-1 transition-transform"></i>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);
                });
            },

            projects() {
                const container = document.getElementById('projects-grid');
                portfolioData.projects.forEach(project => {
                    const html = `
                        <div data-modal-key="project-${project.id}" class="interactive-card group bg-white dark:bg-slate-800 rounded-2xl overflow-hidden border border-slate-200 dark:border-slate-700 shadow-sm hover:shadow-xl-2 hover:border-primary-300 dark:hover:border-primary-700 transition-all duration-300 fade-in-section">
                            <div class="p-6">
                                <div class="flex items-start justify-between mb-4">
                                    <div class="p-3 rounded-lg bg-slate-50 dark:bg-slate-700 group-hover:bg-primary-50 dark:group-hover:bg-primary-900/20 transition-colors">
                                        <i data-lucide="${project.icon}" class="w-6 h-6 ${project.color}"></i>
                                    </div>
                                    <i data-lucide="maximize-2" class="w-5 h-5 text-slate-300 group-hover:text-primary-500 transition-colors"></i>
                                </div>
                                <h3 class="text-lg font-bold text-slate-900 dark:text-white mb-2 group-hover:text-primary-600 transition-colors">${project.title}</h3>
                                <p class="text-slate-600 dark:text-slate-400 text-sm mb-4">${project.description}</p>
                                <div class="flex flex-wrap gap-2">
                                    ${project.tags.map(tag => `<span class="text-xs px-2 py-1 rounded bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300">${tag}</span>`).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);
                });
            },

            notes(filterText = '') {
                const container = document.getElementById('notes-grid');
                container.innerHTML = '';
                const loadMoreBtn = document.getElementById('load-more-container');
                
                let filtered = portfolioData.notes.filter(note => {
                    const search = filterText.toLowerCase();
                    return note.title.toLowerCase().includes(search) || 
                           note.keywords.toLowerCase().includes(search);
                });

                if (filtered.length === 0) {
                    container.innerHTML = `<div class="col-span-full text-center py-8 text-slate-500">No notes found matching "${filterText}"</div>`;
                    loadMoreBtn.classList.add('hidden');
                    return;
                }

                const displaySet = filtered.slice(0, state.notesVisibleCount);
                
                displaySet.forEach(note => {
                    const html = `
                        <div data-modal-key="note-${note.id}" class="interactive-card bg-white dark:bg-slate-800 p-5 rounded-xl border border-slate-200 dark:border-slate-700 hover:border-primary-300 dark:hover:border-primary-700 shadow-sm hover:shadow-md transition-all fade-in-section group">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center gap-3">
                                    <i data-lucide="file-text" class="w-5 h-5 text-primary-500"></i>
                                    <h4 class="font-bold text-slate-900 dark:text-white group-hover:text-primary-600 transition-colors">${note.title}</h4>
                                </div>
                                <i data-lucide="eye" class="w-4 h-4 text-slate-300 group-hover:text-primary-500 opacity-0 group-hover:opacity-100 transition-opacity"></i>
                            </div>
                            <p class="text-sm text-slate-600 dark:text-slate-400 mb-3">${note.summary}</p>
                            <div class="text-xs text-slate-400 italic">#${note.keywords.split(' ').join(' #')}</div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', html);
                });

                // Re-init icons for new content
                lucide.createIcons();

                if (filtered.length > state.notesVisibleCount) {
                    loadMoreBtn.classList.remove('hidden');
                } else {
                    loadMoreBtn.classList.add('hidden');
                }
            },

            observeAnimations() {
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('is-visible');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1 });

                document.querySelectorAll('.fade-in-section').forEach(el => observer.observe(el));
            }
        };

        // --- Modal Manager ---
        const modalManager = {
            backdrop: document.getElementById('modal-backdrop'),
            container: document.getElementById('modal-container'),
            title: document.getElementById('modal-title'),
            body: document.getElementById('modal-body'),

            open(key, isHistoryNav = false) {
                let title = '';
                let content = '';

                // 1. Static Modals
                if (portfolioData.modals[key]) {
                    title = portfolioData.modals[key].title;
                    content = portfolioData.modals[key].content;
                }
                // 2. Timeline Items
                else if (key.startsWith('timeline-')) {
                    const id = parseInt(key.split('-')[1]);
                    const item = portfolioData.timeline.find(t => t.id === id);
                    if (item) {
                        title = `${item.date} - ${item.title}`;
                        content = `
                            <div class="prose dark:prose-invert max-w-none">
                                <div class="flex items-center gap-4 mb-6 pb-6 border-b border-slate-100 dark:border-slate-700">
                                    <div class="p-3 rounded-full ${item.color} text-white">
                                        <i data-lucide="${item.icon}" class="w-6 h-6"></i>
                                    </div>
                                    <h3 class="text-2xl font-bold m-0">${item.title}</h3>
                                </div>
                                <p class="lead text-lg">${item.description}</p>
                                ${item.details || ''}
                            </div>
                        `;
                    }
                }
                // 3. Project Items
                else if (key.startsWith('project-')) {
                    const id = key.substring(8); // 'project-p1' -> 'p1'
                    const item = portfolioData.projects.find(p => p.id === id);
                    if (item) {
                        title = item.title;
                        content = `
                            <div class="prose dark:prose-invert max-w-none">
                                <div class="flex items-center justify-between mb-4">
                                    <div class="flex gap-2">
                                        ${item.tags.map(t => `<span class="px-2 py-1 bg-slate-100 dark:bg-slate-700 rounded text-sm font-medium">${t}</span>`).join('')}
                                    </div>
                                </div>
                                <p class="text-lg text-slate-600 dark:text-slate-300 font-medium">${item.description}</p>
                                <hr class="my-6 border-slate-100 dark:border-slate-700">
                                ${item.details || ''}
                            </div>
                        `;
                    }
                }
                // 4. Note Items
                else if (key.startsWith('note-')) {
                    const id = parseInt(key.split('-')[1]);
                    const item = portfolioData.notes.find(n => n.id === id);
                    if (item) {
                        title = item.title;
                        content = `
                            <div class="prose dark:prose-invert max-w-none">
                                <div class="mb-6 p-4 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-100 dark:border-slate-700">
                                    <strong>Summary:</strong> ${item.summary}
                                </div>
                                ${item.fullContent || '<p>Content coming soon...</p>'}
                                <div class="mt-8 text-sm text-slate-400">
                                    Keywords: ${item.keywords}
                                </div>
                            </div>
                        `;
                    }
                }
                // 5. Course Items (Main Course Modal)
                else if (key.startsWith('course-')) {
                    const courseId = key.substring(7); // 'course-cis-2230' -> 'cis-2230'
                    const item = portfolioData.courses.find(c => c.id === courseId);
                    
                    if (item) {
                        title = item.title;
                        // Construct tabs content
                        const tabsContent = {};
                        
                        // Tab 1: Overview
                        tabsContent['Overview'] = `
                            <p class="text-lg">${item.description}</p>
                            <div class="mt-4 grid grid-cols-2 gap-4">
                                <div class="p-3 bg-slate-50 dark:bg-slate-800 rounded">
                                    <span class="text-xs uppercase text-slate-400">Semester</span><br>
                                    <span class="font-medium">${item.semester}</span>
                                </div>
                                <div class="p-3 bg-slate-50 dark:bg-slate-800 rounded">
                                    <span class="text-xs uppercase text-slate-400">Modules</span><br>
                                    <span class="font-medium">${item.weeks.length} Weeks</span>
                                </div>
                            </div>
                        `;

                        // Tabs 2+: Weeks
                        item.weeks.forEach(w => {
                            // Combine all content types for a week into one view for simplicity
                            let weekHtml = `<h4 class="text-xl font-bold mb-4">${w.title}</h4>`;
                            if (w.content.notes) weekHtml += `<div class="mb-6"><h5>Class Notes</h5>${w.content.notes}</div>`;
                            if (w.content.assignment) weekHtml += `<div class="mb-6"><h5>Assignment</h5>${w.content.assignment}</div>`;
                            if (w.content.quiz) weekHtml += `<div class="mb-6"><h5>Quiz Results</h5>${w.content.quiz}</div>`;
                            
                            tabsContent[`Week ${w.week}`] = weekHtml;
                        });

                        content = this.generateTabs(tabsContent);
                    }
                }

                if (!content) return;

                // Render content
                this.title.textContent = title;
                this.body.innerHTML = content;
                lucide.createIcons();

                // Show Modal
                this.backdrop.classList.remove('hidden');
                setTimeout(() => {
                    this.backdrop.classList.remove('opacity-0', 'pointer-events-none');
                    this.container.classList.remove('scale-95', 'opacity-0');
                    this.container.classList.add('scale-100', 'opacity-100');
                }, 10);
                
                document.body.style.overflow = 'hidden';
                state.isModalOpen = true;

                if (!isHistoryNav) {
                    try { history.pushState({ modal: key }, '', `#${key}`); } catch (e) {}
                }

                this.setupTabs();
            },

            close(isHistoryNav = false) {
                this.backdrop.classList.add('opacity-0', 'pointer-events-none');
                this.container.classList.remove('scale-100', 'opacity-100');
                this.container.classList.add('scale-95', 'opacity-0');

                setTimeout(() => {
                    this.backdrop.classList.add('hidden');
                    this.body.innerHTML = '';
                }, 300);

                document.body.style.overflow = '';
                state.isModalOpen = false;

                if (!isHistoryNav && window.location.hash) {
                    try { history.pushState(null, '', window.location.pathname); } 
                    catch (e) { try { window.location.hash = ''; } catch (e2) {} }
                }
            },

            generateTabs(contentObj) {
                const keys = Object.keys(contentObj);
                if (keys.length === 0) return '<p>No content available.</p>';

                const tabsHeader = `
                    <div class="flex border-b border-slate-200 dark:border-slate-700 mb-4 overflow-x-auto no-scrollbar">
                        ${keys.map((k, i) => `
                            <button class="tab-btn px-4 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap capitalize ${i === 0 ? 'border-primary-600 text-primary-600 dark:text-primary-400' : 'border-transparent text-slate-500 hover:text-slate-700 dark:text-slate-400 dark:hover:text-slate-200'}" data-tab="${k}">
                                ${k}
                            </button>
                        `).join('')}
                    </div>
                `;

                const tabsBody = `
                    <div class="tab-content-container min-h-[200px]">
                        ${keys.map((k, i) => `
                            <div class="tab-pane prose dark:prose-invert max-w-none ${i === 0 ? 'block' : 'hidden'}" data-pane="${k}">
                                ${contentObj[k]}
                            </div>
                        `).join('')}
                    </div>
                `;

                return tabsHeader + tabsBody;
            },

            setupTabs() {
                const btns = this.body.querySelectorAll('.tab-btn');
                const panes = this.body.querySelectorAll('.tab-pane');

                btns.forEach(btn => {
                    btn.addEventListener('click', () => {
                        btns.forEach(b => {
                            b.classList.remove('border-primary-600', 'text-primary-600', 'dark:text-primary-400');
                            b.classList.add('border-transparent', 'text-slate-500');
                        });
                        btn.classList.remove('border-transparent', 'text-slate-500');
                        btn.classList.add('border-primary-600', 'text-primary-600', 'dark:text-primary-400');

                        const target = btn.dataset.tab;
                        panes.forEach(p => {
                            p.classList.add('hidden');
                            if (p.dataset.pane === target) p.classList.remove('hidden');
                        });
                    });
                });
            }
        };

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            themeManager.init();
            render.init();

            // Mobile Menu
            const mobileBtn = document.getElementById('mobile-menu-btn');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileBtn.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            // Theme Toggle
            document.getElementById('theme-toggle').addEventListener('click', () => themeManager.toggle());

            // Search Logic
            const searchInput = document.getElementById('notes-search');
            const clearBtn = document.getElementById('clear-search');
            
            searchInput.addEventListener('input', (e) => {
                render.notes(e.target.value);
                if(e.target.value) clearBtn.classList.remove('hidden');
                else clearBtn.classList.add('hidden');
            });
            
            clearBtn.addEventListener('click', () => {
                searchInput.value = '';
                render.notes();
                clearBtn.classList.add('hidden');
                searchInput.focus();
            });

            // Load More Notes
            document.getElementById('load-more-btn').addEventListener('click', () => {
                state.notesVisibleCount += state.notesIncrement;
                render.notes(searchInput.value);
            });

            // Modal Triggers (Delegation)
            document.addEventListener('click', (e) => {
                const trigger = e.target.closest('[data-modal-key]');
                if (trigger) {
                    const key = trigger.dataset.modalKey;
                    modalManager.open(key);
                }
            });

            // Modal Close Triggers
            document.getElementById('modal-close').addEventListener('click', () => modalManager.close());
            document.getElementById('modal-backdrop').addEventListener('click', (e) => {
                if (e.target === document.getElementById('modal-backdrop')) modalManager.close();
            });
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && state.isModalOpen) modalManager.close();
            });

            // History API / Deep Linking Support
            window.addEventListener('popstate', (event) => {
                if (event.state && event.state.modal) {
                    modalManager.open(event.state.modal, true);
                } else {
                    modalManager.close(true);
                }
            });

            // Check URL on load
            if (window.location.hash) {
                const key = window.location.hash.substring(1);
                modalManager.open(key, true);
            }
        });

    </script>
</body>
</html>